package com.example.demo.service;

import java.time.LocalDateTime;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.example.demo.entity.Account;
import com.example.demo.repository.jpa.AccountRepository;

// LikeService.java
@Service
public class LikeService {

    @Autowired
    private AccountRepository accountRepository;

    // アカウントのいいね数を1増加させる
    public int likeAccount(Long accountId) {
        Account account = accountRepository.findById(accountId).orElse(null);
        if (account != null) {
            int currentLikes = account.getLikes();
            account.setLikes(currentLikes + 1);
            accountRepository.save(account);
            System.out.println("Updated likes for account ID: " + accountId + " to " + (currentLikes + 1)); // ログ出力
            return account.getLikes(); // 更新後のいいね数を返す
        } else {
            throw new RuntimeException("Account not found with ID: " + accountId);
        }
    }

    // 月ごとのいいねランキング
    public List<Account> findTopLikedAccountsForPeriod(LocalDateTime startDateTime, LocalDateTime endDateTime) {
        return accountRepository.findTopLikedAccountsForPeriod(startDateTime, endDateTime);
    }
}
